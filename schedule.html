<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Mirrativ Event Schedule</title>
<style>
body{
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background:#0e0e11;
  color:#fff;
  margin:0;
  padding:0;
}
h1{
  text-align:center;
  margin:20px 0;
}

/* ==== ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ç¤º ==== */
#schedule{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
  padding:16px;
}
.card{
  background:#1a1b20;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 6px 14px rgba(0,0,0,.4);
  transition: transform .2s;
}
.card:hover{
  transform:scale(1.03);
}
.image-box{
  aspect-ratio:1/1;
  background:#000;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.image-box img{
  width:100%;
  height:100%;
  object-fit:contain;
}
.time{
  padding:8px;
  font-size:12px;
  text-align:center;
  opacity:.8;
}
.status{
  text-align:center;
  font-size:12px;
  font-weight:bold;
  margin-bottom:4px;
}
.active{ color:#4fff4f; }
.upcoming{ color:#ffd700; }
.ended{ color:#888; }

/* ==== ãƒ­ãƒƒã‚¯ç”»é¢ ==== */
#lock{
  position:fixed;
  top:0; left:0; width:100%; height:100%;
  background:#0b0b10;
  display:flex; justify-content:center; align-items:center;
  z-index:9999;
}
.lock-box{
  background:#0b0b10;
  border-radius:20px;
  padding:40px 32px;
  width:90%;
  max-width:420px;
  text-align:center;
  box-shadow:0 0 40px rgba(255,0,0,.25);
}
.lock-box h2{
  color:#ff3b3b;
  margin-bottom:10px;
  font-size:30px;
}
.warning{
  margin:20px 0 26px;
  font-size:14px;
  line-height:1.6;
  color:#ddd;
}
.warning strong{ color:#ff5b5b; font-size:18px; }
.warning .danger{ color:#ff8a8a; font-weight:600; }
#pw{
  padding:10px;
  width:80%;
  border-radius:10px;
  border:none;
  font-size:16px;
  margin-bottom:10px;
}
#unlockBtn{
  padding:10px 20px;
  border:none;
  border-radius:10px;
  background:#ff3b3b;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
#version{
  margin-top:12px;
  font-size:12px;
  opacity:.6;
}
</style>
</head>
<body>

<div id="lock">
  <div class="lock-box">
    <h2>Access Restricted</h2>
    <div class="warning">
      <strong>ãƒªãƒ¼ã‚¯æƒ…å ±é–²è¦§ã®ãŸã‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™</strong><br>
      ã“ã®ãƒšãƒ¼ã‚¸ã«ã¯æœªå…¬é–‹æƒ…å ±ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆå†…éƒ¨æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚<br>
      <span class="danger">é–¢ä¿‚è€…ä»¥å¤–ã®é–²è¦§ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚</span>
    </div>
    <input type="password" id="pw" placeholder="Enter Password" />
    <button id="unlockBtn">Unlock</button>
    <div id="version">v2026-01-06-v1</div>
  </div>
</div>

<h1>ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h1>
<div id="schedule"></div>

<script>
// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·
const PASSWORD = "johnleak";
const LOCK = document.getElementById("lock");
const stored = localStorage.getItem("mirrativ_pass");
if(stored === PASSWORD){
  LOCK.style.display = "none";
}

document.getElementById("unlockBtn").onclick = ()=>{
  const val = document.getElementById("pw").value;
  if(val === PASSWORD){
    LOCK.style.display="none";
    localStorage.setItem("mirrativ_pass", PASSWORD);
  }else{
    alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
  }
}

// ğŸ”— Mirrativç›´é€šãƒªãƒ³ã‚¯
function directLink(url){
  return "mirr://webview/window/open?url=" + encodeURIComponent(url);
}

// ğŸ“¦ JSONèª­ã¿è¾¼ã¿
async function loadSchedule(){
  const listRes = await fetch("schedule/index.json");
  const files = await listRes.json();
  let events = [];
  for(const file of files){
    const res = await fetch("schedule/" + file);
    const data = await res.json();
    events = events.concat(data);
  }
  render(events);
}

// ğŸ–¼ æç”»
function render(events){
  const wrap = document.getElementById("schedule");
  // é‡è¤‡å‰Šé™¤ (URL+image+start)
  const unique = [];
  const seen = new Set();
  for(const e of events){
    const key = e.url + e.image + e.start;
    if(!seen.has(key)){
      seen.add(key);
      unique.push(e);
    }
  }
  // æ—¥ä»˜é †
  unique.sort((a,b)=> new Date(a.start)-new Date(b.start));

  const now = new Date();
  for(const e of unique){
    const card = document.createElement("div");
    card.className = "card";

    const box = document.createElement("div");
    box.className = "image-box";
    box.onclick = ()=> location.href = directLink(e.url);

    if(e.image){
      const img = document.createElement("img");
      img.src = e.image;
      box.appendChild(img);
    }else{
      box.textContent = "No Image";
    }

    const status = document.createElement("div");
    status.className="status";
    const sdate = new Date(e.start);
    const edate = new Date(e.end);
    if(now >= sdate && now <= edate) status.textContent="é–‹å‚¬ä¸­", status.classList.add("active");
    else if(now < sdate) status.textContent="é–‹å‚¬äºˆå®š", status.classList.add("upcoming");
    else status.textContent="çµ‚äº†", status.classList.add("ended");

    const time = document.createElement("div");
    time.className="time";
    time.textContent = sdate.toLocaleDateString() + " ï½ " + edate.toLocaleDateString();

    card.append(status, box, time);
    wrap.appendChild(card);
  }
}

loadSchedule();
</script>
</body>
</html>
