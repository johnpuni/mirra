<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>„Ç®„É¢„É¢„Ç§„Éô„É≥„ÉàÊ§úÁ¥¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --bg: #fff;
      --text: #222;
      --accent: #4CAF50;
      --card-bg: #f9f9f9;
    }
    body.dark {
      --bg: #121212;
      --text: #eee;
      --accent: #81C784;
      --card-bg: #1e1e1e;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      padding: 10px;
      background: var(--accent);
      color: #fff;
      text-align: center;
      font-size: 1.2em;
    }
    .controls {
      padding: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
    }
    .controls input[type="text"] {
      flex: 1 1 200px;
      padding: 8px;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .controls select, .controls button {
      padding: 6px 10px;
      font-size: 0.9em;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: var(--card-bg);
      color: var(--text);
      cursor: pointer;
    }
    .toggle-group button {
      border: 1px solid var(--accent);
      background: var(--bg);
      color: var(--text);
    }
    .toggle-group button.active {
      background: var(--accent);
      color: #fff;
    }
    .year-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: center;
      margin: 10px 0;
    }
    .year-tabs button {
      padding: 6px 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: var(--card-bg);
      cursor: pointer;
    }
    .year-tabs button.active {
      background: var(--accent);
      color: #fff;
    }
    .event-list {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(120px,1fr));
      gap: 10px;
      padding: 10px;
    }
    .event-card {
      background: var(--card-bg);
      border-radius: 6px;
      overflow: hidden;
      text-align: center;
    }
    .event-card img {
      width: 100%;
      display: block;
    }
    #scrollTopBtn {
      position: fixed;
      bottom: 15px;
      right: 15px;
      display: none;
      padding: 10px;
      border-radius: 50%;
      border: none;
      background: var(--accent);
      color: #fff;
      font-size: 1.2em;
      cursor: pointer;
    }
  </style>
</head>
<body>
<header>üéâ „Ç®„É¢„É¢„Ç§„Éô„É≥„ÉàÊ§úÁ¥¢</header>

<div class="controls">
  <input type="text" id="searchBox" placeholder="„Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢">
  <div class="toggle-group">
    <button id="andBtn" class="active">AND</button>
    <button id="orBtn">OR</button>
  </div>
  <select id="categoryFilter">
    <option value="all">ÂÖ®„Ç´„ÉÜ„Ç¥„É™</option>
    <option value="„Ç®„É¢„Éê„Éà">„Ç®„É¢„Éê„Éà</option>
    <option value="„Ç®„É¢„É©„É≥">„Ç®„É¢„É©„É≥</option>
    <option value="„ÇÆ„Éï„Ç¨„ÉÅ„É£">„ÇÆ„Éï„Ç¨„ÉÅ„É£</option>
    <option value="„É´„É¨">„É´„É¨</option>
  </select>
  <button id="darkModeBtn">üåô</button>
</div>

<div class="year-tabs" id="yearTabs"></div>

<div id="eventList" class="event-list"></div>

<button id="scrollTopBtn">‚Üë</button>

<script>
const eventData = {
  "2025": [
    { title: "„Ç®„É¢„Éê„ÉàÔºàS001Ôºâ„Çπ„Éö„Ç∑„É£„É´", img: "images/emo1.webp", link: "#", date: "2025-01-10", keywords: ["2025","„Ç®„É¢„Éê„ÉàÔºàS001Ôºâ","„ÇÆ„Éï„Ç¨„ÉÅ„É£"] },
    { title: "„Ç®„É¢„É©„É≥ÔºàS002Ôºâ„ÉÅ„É£„É¨„É≥„Ç∏", img: "images/emo2.webp", link: "#", date: "2025-02-15", keywords: ["2025","„Ç®„É¢„É©„É≥ÔºàS002Ôºâ","„É´„É¨"] },
    { title: "„ÇÆ„Éï„Éà„Ç¨„ÉÅ„É£ÈôêÂÆö", img: "images/emo3.webp", link: "#", date: "2025-03-01", keywords: ["2025","„ÇÆ„Éï„Ç¨„ÉÅ„É£"] }
  ],
  "2024": [
    { title: "„Ç®„É¢„É©„É≥ÔºàS010ÔºâÂæ©Âàª", img: "images/emo4.webp", link: "#", date: "2024-12-20", keywords: ["2024","„Ç®„É¢„É©„É≥ÔºàS010Ôºâ"] },
    { title: "„É´„Éº„É¨„ÉÉ„Éà„Éï„Çß„Çπ", img: "images/emo5.webp", link: "#", date: "2024-11-05", keywords: ["2024","„É´„É¨"] }
  ]
};

let currentYear = "all";
let currentQuery = "";
let searchMode = "AND";
let currentCategory = "all";

function normalize(str){
  return str.toLowerCase()
    .replace(/[Ôº°-Ôº∫ÔΩÅ-ÔΩöÔºê-Ôºô]/g,s=>String.fromCharCode(s.charCodeAt(0)-0xFEE0))
    .replace(/[„ÅÅ-„Çì]/g,s=>String.fromCharCode(s.charCodeAt(0)+0x60));
}

function renderEvents(){
  const list=document.getElementById("eventList");
  list.innerHTML="";
  let events=[];
  Object.values(eventData).forEach(arr=>events=events.concat(arr));

  if(currentYear!=="all"){
    events=events.filter(ev=>ev.date.startsWith(currentYear));
  }

  if(currentQuery){
    const query=normalize(currentQuery);
    events=events.filter(ev=>{
      const haystack=normalize(ev.title+" "+ev.keywords.join(" "));
      if(searchMode==="AND"){
        return query.split(" ").every(q=>haystack.includes(q));
      }else{
        return query.split(" ").some(q=>haystack.includes(q));
      }
    });
  }

  if(currentCategory!=="all"){
    events=events.filter(ev=>
      ev.keywords.some(k=>k.includes(currentCategory))
    );
  }

  list.innerHTML=events.map(ev=>
    `<div class="event-card">
      <a href="${ev.link}">
        <img src="${ev.img}" alt="${ev.title}">
      </a>
    </div>`
  ).join('');
}

function renderYearTabs(){
  const tabs=document.getElementById("yearTabs");
  const years=Object.keys(eventData).sort((a,b)=>b-a);
  tabs.innerHTML=`<button data-year="all" class="active">ÂÖ®„Å¶</button>`+
    years.map(y=>`<button data-year="${y}">${y}</button>`).join("");
  tabs.querySelectorAll("button").forEach(btn=>{
    btn.addEventListener("click",()=>{
      tabs.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      currentYear=btn.dataset.year;
      renderEvents();
    });
  });
}

document.getElementById("searchBox").addEventListener("input",e=>{
  currentQuery=e.target.value;
  renderEvents();
});
document.getElementById("andBtn").addEventListener("click",()=>{
  searchMode="AND";
  document.getElementById("andBtn").classList.add("active");
  document.getElementById("orBtn").classList.remove("active");
  renderEvents();
});
document.getElementById("orBtn").addEventListener("click",()=>{
  searchMode="OR";
  document.getElementById("orBtn").classList.add("active");
  document.getElementById("andBtn").classList.remove("active");
  renderEvents();
});
document.getElementById("categoryFilter").addEventListener("change",e=>{
  currentCategory=e.target.value;
  renderEvents();
});
document.getElementById("darkModeBtn").addEventListener("click",()=>{
  document.body.classList.toggle("dark");
});

const scrollBtn=document.getElementById("scrollTopBtn");
window.addEventListener("scroll",()=>{
  scrollBtn.style.display=window.scrollY>200?"block":"none";
});
scrollBtn.addEventListener("click",()=>{
  window.scrollTo({top:0,behavior:"smooth"});
});

renderYearTabs();
renderEvents();
</script>
</body>
</html>
