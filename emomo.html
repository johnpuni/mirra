  function displayEvents(year, keyword = '') {
    let events = [];

    if (keyword) {
      const keywordsArray = keyword.split(/\s+/).map(k => k.toLowerCase());

      for (const y in eventData) {
        events = events.concat(eventData[y]);
      }

      const filtered = events.filter(e => {
        const title = e.title.toLowerCase();
        const allKeywords = (e.keywords || []).map(k => k.toLowerCase());

        return keywordsArray.some(k =>
          title.includes(k) ||
          allKeywords.some(kw => kw.includes(k))
        );
      });

      renderEvents(filtered);
    } else {
      // 検索語なしは選択中の年度だけ表示
      events = eventData[year] || [];
      renderEvents(events);
    }
  }
