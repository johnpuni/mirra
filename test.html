javascript:(async(()=>{
    const uid = prompt("視聴したい配信者のIDを入力してください", "110544066");
    if(!uid) return;

    try {
        console.log("データ取得中...");
        // 1. 配信履歴からLiveIDを取得
        const hRes = await fetch(`https://www.mirrativ.com/api/live/live_history?user_id=${uid}`);
        const hData = await hRes.json();
        if(!hData.lives || hData.lives.length === 0) return alert("配信が見つかりませんでした。");
        
        const liveId = hData.lives[0].live_id;

        // 2. 配信URLを取得
        const sRes = await fetch(`https://www.mirrativ.com/api/live/get_streaming_url?live_id=${liveId}`);
        const sData = await sRes.json();
        const m3u8 = sData.streaming_url_hls;

        if(!m3u8) return alert("映像URLが取得できませんでした。");

        // 3. 簡易プレイヤーを画面上に表示
        let v = document.getElementById('mira-player');
        if(!v){
            v = document.createElement('video');
            v.id = 'mira-player';
            v.controls = true;
            v.style = "position:fixed; top:10px; right:10px; width:400px; z-index:999999; border:2px solid #ff005c; background:#000;";
            document.body.appendChild(v);
        }

        if (v.canPlayType('application/vnd.apple.mpegurl')) {
            v.src = m3u8;
        } else {
            const script = document.createElement('script');
            script.src = "https://cdn.jsdelivr.net/npm/hls.js@latest";
            script.onload = () => {
                const hls = new Hls();
                hls.loadSource(m3u8);
                hls.attachMedia(v);
                hls.on(Hls.Events.MANIFEST_PARSED, () => v.play());
            };
            document.head.appendChild(script);
        }
        alert("再生を開始します！画面右上のプレイヤーを確認してください。");

    } catch (e) {
        alert("エラーが発生しました。ミラティブのサイトを一度開いてから試してください。");
        console.error(e);
    }
}))();
