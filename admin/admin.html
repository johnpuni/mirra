<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚¨ãƒ¢ãƒ¢ç®¡ç†ãƒ„ãƒ¼ãƒ«</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      background-color: #f5f5f5;
    }
    header {
      background-color: #333;
      padding: 12px;
      text-align: center;
      color: white;
      font-size: 1.3em;
    }
    main {
      max-width: 960px;
      margin: 20px auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .entry {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 6px;
      position: relative;
    }
    .entry h3 {
      margin-top: 0;
    }
    .entry input,
    .entry textarea {
      width: 100%;
      margin-top: 5px;
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    .entry .error {
      color: red;
      font-size: 0.9em;
    }
    .remove-button {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      padding: 4px 8px;
    }
    button {
      padding: 10px 16px;
      font-size: 15px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      margin: 5px;
    }
    #jsonOutput {
      white-space: pre-wrap;
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      padding: 12px;
      margin-top: 20px;
      border-radius: 6px;
      font-family: monospace;
    }
    #copyBtn {
      background-color: #2980b9;
      color: white;
    }
    #addBtn {
      background-color: #27ae60;
      color: white;
    }
  </style>
</head>
<body>
<header>ğŸ“¦ ã‚¨ãƒ¢ãƒ¢ã‚¤ãƒ™ãƒ³ãƒˆ JSON ä½œæˆãƒ„ãƒ¼ãƒ«</header>
<main>
  <div id="entryContainer"></div>
  <button id="addBtn">ï¼‹ ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ </button>
  <button onclick="generateJSON()">âœ… JSONç”Ÿæˆ</button>
  <button id="copyBtn" onclick="copyJSON()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
  <div id="jsonOutput"></div>
</main>
<script>
let entryIndex = 0;

function createEntry() {
  const container = document.getElementById("entryContainer");
  const entry = document.createElement("div");
  entry.className = "entry";
  entry.innerHTML = `
    <h3>ã‚¤ãƒ™ãƒ³ãƒˆ ${entryIndex + 1}</h3>
    <label>ã‚¿ã‚¤ãƒˆãƒ«:</label>
    <textarea class="title"></textarea>
    <label>ç”»åƒç•ªå·ï¼ˆä¾‹: 3146ï¼‰:</label>
    <input type="text" class="img">
    <label>ãƒªãƒ³ã‚¯ï¼ˆä¾‹: mirr:///notice/r?c=6166ï¼‰:</label>
    <input type="text" class="link">
    <label>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰:</label>
    <input type="text" class="keywords">
    <label>æ—¥ä»˜ï¼ˆä¾‹: 2025-01-01ï¼‰:</label>
    <input type="date" class="date">
    <div class="error"></div>
    <button class="remove-button" onclick="this.parentElement.remove()">å‰Šé™¤</button>
  `;
  container.appendChild(entry);
  entryIndex++;
}

function generateJSON() {
  const entries = document.querySelectorAll(".entry");
  const result = [];
  let hasError = false;

  entries.forEach(entry => {
    const title = entry.querySelector(".title").value.trim();
    const img = entry.querySelector(".img").value.trim();
    const link = entry.querySelector(".link").value.trim();
    const keywords = entry.querySelector(".keywords").value.trim();
    const date = entry.querySelector(".date").value;
    const errorDiv = entry.querySelector(".error");
    errorDiv.textContent = "";

    if (!title || !img || !link || !keywords || !date) {
      errorDiv.textContent = "ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
      hasError = true;
      return;
    }

    if (!/^\d+$/.test(img)) {
      errorDiv.textContent = "ç”»åƒç•ªå·ãŒä¸æ­£ã§ã™ã€‚æ•°å­—ã®ã¿ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
      hasError = true;
      return;
    }

    if (!/^mirr:\/\/\/notice\/r\?c=\d+$/.test(link)) {
      errorDiv.textContent = "ãƒªãƒ³ã‚¯ã®å½¢å¼ãŒä¸æ­£ã§ã™ã€‚";
      hasError = true;
      return;
    }

    const keywordArray = keywords.split(",").map(k => k.trim()).filter(k => k);
    if (keywordArray.length === 0) {
      errorDiv.textContent = "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’1ã¤ä»¥ä¸Šå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
      hasError = true;
      return;
    }

    result.push({
      title: title,
      img: "images/" + img + ".webp",
      link: link,
      keywords: keywordArray,
      date: date
    });
  });

  if (!hasError) {
    document.getElementById("jsonOutput").textContent = JSON.stringify(result, null, 2);
  } else {
    document.getElementById("jsonOutput").textContent = "";
  }
}

function copyJSON() {
  const json = document.getElementById("jsonOutput").textContent;
  navigator.clipboard.writeText(json).then(() => {
    alert("JSONã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
  });
}

document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("addBtn").addEventListener("click", createEntry);
  createEntry();
});
</script>
</body>
</html>
